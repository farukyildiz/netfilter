# Permit max QUOTA bytes from protocol tcp and port 80 (ROUTED TRAFFIC, we are the ROUTER)
# Traffic is generated by a server inside out LAN.
# This is downloaded traffic by Internet clients from our server

PROTOCOL="tcp"
PORT="80"
# 1GB
QUOTA1="1000000000"
# This is the outgoing interface
INT="eth0"

iptables -A FORWARD -o $INT -p $PROTOCOL --sport $PORT -m quota --quota $QOUTA1 -j ACCEPT
iptables -A FORWARD -o $INT -p $PROTOCOL --sport $PORT -j DROP

# Permit max 100MB of incoming https traffic from the web site with the address 100.0.0.1
iptables -A INPUT -s 100.0.0.1 -p tcp --sport 443 -m quota --quota 100000000 -j ACCEPT
iptables -A INPUT -s 100.0.0.1 -p tcp --sport 443 -j DROP